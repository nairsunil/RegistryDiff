pipeline {
    agent any
    environment
    {
         GIT_PATH="D:\\LocalhostJenkins\\RegdiffProject"
    }
    stages {
        stage('build') {
            steps {
                bat 'whoami'
                 dir("${env.GIT_PATH}") {
                    checkout([$class: 'GitSCM', 
                    branches: [[name: '*/main']], 
                    doGenerateSubmoduleConfigurations: false, 
                    submoduleCfg: [], 
                    userRemoteConfigs: [[credentialsId: 'PATForSunilRepo', url: 'https://github.com/nairsunil/RegistryDiff.git']]])
                }
                
            }
        }
        stage('get_commit_msg') {
            steps {
                script {
                    env.GIT_COMMIT_MSG = bat (script: 'git log -1 --pretty=%B ${GIT_COMMIT}', returnStdout: true).trim()
                }
            }
        }
    }
    post{
        success{
            echo "Latest commit message: \${GIT_COMMIT_MSG}"
        }
    }
}
